# 创建数据库集合指南

## 快速创建步骤

### 1. 打开云开发控制台

1. 打开微信开发者工具
2. 点击顶部菜单栏的"云开发"按钮
3. 进入"数据库"标签

### 2. 创建集合（统一使用简化规则）

**重要**：所有集合创建时都使用以下**统一的安全规则**，避免语法错误：

```javascript
{
  "read": "auth != null",
  "write": "auth != null"
}
```

### 3. 需要创建的集合列表

按以下顺序创建集合，每个都使用上面的统一规则：

1. ✅ **tenants** - 租户表
2. ✅ **users** - 用户表
3. ✅ **students** - 学生表
4. ✅ **teachers** - 教师表
5. ✅ **classrooms** - 教室表
6. ✅ **schedules** - 课表表
7. ✅ **attendance** - 考勤表
8. ✅ **study_reports** - 学习报告表
9. ✅ **notification_messages** - 消息表
10. ✅ **audit_logs** - 审计日志表

### 4. 创建每个集合的详细步骤

对每个集合重复以下步骤：

1. 点击"添加集合"按钮
2. 输入集合名称（如：`users`）
3. **权限设置**：选择"**自定义安全规则**"
4. **粘贴以下规则**：
   ```javascript
   {
     "read": "auth != null",
     "write": "auth != null"
   }
   ```
5. 点击"确定"创建

### 5. 验证创建成功

创建后应该能看到：
- 集合列表中出现新创建的集合
- 集合状态显示正常
- 可以点击进入集合详情

## 常见问题

### Q: 为什么使用这么简单的规则？

A: 
- 避免创建时的语法错误
- 先保证集合能创建成功
- 多租户隔离和权限控制在云函数层面实现
- 后续登录功能完善后再细化安全规则

### Q: 这样安全吗？

A: 
- 这个规则确保只有登录用户才能访问
- 多租户隔离通过云函数中的 `tenant_id` 过滤实现
- 后续会细化安全规则，增加更严格的权限控制

### Q: 什么时候细化安全规则？

A: 
- 等阶段2（用户认证模块）完成后
- 等登录功能测试通过后
- 再按文档中的细化规则更新

## 创建完成后

创建完所有10个集合后：
- ✅ 可以开始创建云函数
- ✅ 可以开始开发登录功能
- ✅ 后续再优化索引和安全规则

